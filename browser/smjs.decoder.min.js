!function(t,_){if("function"==typeof define&&define.amd)define(["exports"],function(_){t(_)});else if("undefined"!=typeof exports)t(exports);else{var T=_.SMJS;_.SMJS={noConflict:function(){return _.SMJS=T,this}},t(_.SMJS)}}(function(t){"use strict";function _(t){for(var _=r.length,T=t%_,e=Math.floor(t/_),i=r.charAt(T);e;)T=e%_,e=Math.floor(e/_),i=r.charAt(T)+i;return i}function T(t){var T=_(t);return T.length<2&&(T=r[0]+T),T}function e(t){for(var _=r.length,T=0,e=t.length,i=0;e>i;++i)T=T*_+r.indexOf(t.charAt(i));return T}var i=t.COMMON={version:"0.0.1-alpha.3"},r="0123456789aAbBcCdDeEfFgGhHiIjJkKlLmMnNoOpPqQrRsStTuUvVwWxXyYzZ-_.!~*()";i.d2r=_,i.d2r2=T,i.r2d=e,i.AST_TOKEN="token",i.AST_NODE="node",i.AST_BODY="body",i.AST_LITERAL="literal",i.AST_OPERATOR="operator",i.AST_LEFT="left",i.AST_RIGHT="right",i.AST_ARGUMENTS="arguments",i.AST_INIT="init",i.AST_TEST="test",i.AST_UPDATE="update",i.AST_CATCH="catch",i.AST_FINALLY="finally",i.AST_ALT="alt",i.AST_OBJDEF="objdef",i.AST_VARDEF="vardef",i.AST_NODES={},i.T_END="'",i.T_LITERAL_TABLE="0",i.T_LITERAL_1="1",i.T_LITERAL_2="2",i.T_LITERAL_3="3",i.T_LITERAL_4="4",i.T_ASSIGN="a",i.AST_NODES[i.T_ASSIGN]=[i.AST_OPERATOR,i.AST_LEFT,i.AST_RIGHT],i.T_ARRAY="A",i.AST_NODES[i.T_ARRAY]=[i.AST_BODY],i.T_BOP="b",i.AST_NODES[i.T_BOP]=[i.AST_OPERATOR,i.AST_LEFT,i.AST_RIGHT],i.T_BREAK="B",i.AST_NODES[i.T_BREAK]=[i.AST_LITERAL],i.T_CALL="c",i.AST_NODES[i.T_CALL]=[i.AST_NODE,i.AST_ARGUMENTS],i.T_CONTINUE="C",i.AST_NODES[i.T_CONTINUE]=[i.AST_LITERAL],i.T_EXPR="E",i.AST_NODES[i.T_EXPR]=[i.AST_NODE],i.T_FUNC="f",i.AST_NODES[i.T_FUNC]=[i.AST_LITERAL,i.AST_ARGUMENTS,i.AST_NODE],i.T_FOR="F",i.AST_NODES[i.T_FOR]=[i.AST_INIT,i.AST_TEST,i.AST_UPDATE,i.AST_NODE],i.T_FOR_IN="g",i.AST_NODES[i.T_FOR_IN]=[i.AST_LEFT,i.AST_RIGHT,i.AST_NODE],i.T_THROW="G",i.AST_NODES[i.T_THROW]=[i.AST_NODE],i.T_TRY="h",i.AST_NODES[i.T_TRY]=[i.AST_NODE,i.AST_CATCH,i.AST_FINALLY],i.T_CATCH="H",i.AST_NODES[i.T_CATCH]=[i.AST_LITERAL,i.AST_NODE],i.T_IF="I",i.AST_NODES[i.T_IF]=[i.AST_TEST,i.AST_NODE,i.AST_ALT],i.T_PREUPDATE="j",i.AST_NODES[i.T_PREUPDATE]=[i.AST_OPERATOR,i.AST_NODE],i.T_POSTUPDATE="J",i.AST_NODES[i.T_POSTUPDATE]=[i.AST_OPERATOR,i.AST_NODE],i.T_SWITCH="k",i.AST_NODES[i.T_SWITCH]=[i.AST_NODE,i.AST_BODY],i.T_SWITCH_CASE="K",i.AST_NODES[i.T_SWITCH_CASE]=[i.AST_TEST,i.AST_BODY],i.T_LITERAL="l",i.T_LITERAL_CODE="L",i.AST_NODES[i.T_LITERAL]=[i.AST_LITERAL],i.T_DOT_MEMBER="m",i.AST_NODES[i.T_DOT_MEMBER]=[i.AST_LEFT,i.AST_RIGHT],i.T_ARRAY_MEMBER="M",i.AST_NODES[i.T_ARRAY_MEMBER]=[i.AST_LEFT,i.AST_RIGHT],i.T_NEW="n",i.AST_NODES[i.T_NEW]=[i.AST_NODE,i.AST_ARGUMENTS],i.T_ORDER="o",i.AST_NODES[i.T_ORDER]=[i.AST_NODE],i.T_OBJECT="O",i.AST_NODES[i.T_OBJECT]=[i.AST_OBJDEF],i.T_RETURN="r",i.AST_NODES[i.T_RETURN]=[i.AST_NODE],i.T_SEQ="S",i.AST_NODES[i.T_SEQ]=[i.AST_BODY],i.T_TABLE="t",i.T_THIS="T",i.AST_NODES[i.T_THIS]=[],i.T_UOP="u",i.AST_NODES[i.T_UOP]=[i.AST_OPERATOR,i.AST_NODE],i.T_VAR="v",i.AST_NODES[i.T_VAR]=[i.AST_VARDEF],i.T_DO_WHILE="V",i.AST_NODES[i.T_DO_WHILE]=[i.AST_NODE,i.AST_TEST],i.T_WHILE="w",i.AST_NODES[i.T_WHILE]=[i.AST_TEST,i.AST_NODE],i.T_WITH="W",i.AST_NODES[i.T_WITH]=[i.AST_NODE,i.AST_ALT],i.T_LABEL="z",i.AST_NODES[i.T_LABEL]=[i.AST_LITERAL,i.AST_NODE],i.T_CONDITIONAL="Z",i.AST_NODES[i.T_CONDITIONAL]=[i.AST_TEST,i.AST_NODE,i.AST_ALT],i.T_EMPTY=".",i.AST_NODES[i.T_EMPTY]=[],i.T_NULL="!",i.T_BLOCK="(",i.AST_NODES[i.T_BLOCK]=[i.AST_BODY],i.LITERAL_CODE_TABLE=["undefined","null","true","false","NaN","Infinity","-Infinity","-","+","!","~","typeof","void","delete","==","!=","===","!==","<","<=",">",">=","<<",">>",">>>","*","/","%","|","^","&","in","instanceof","..","||","&&","=","+=","-=","*=","/=","%=","<<=",">>=",">>>=","|=","^=","&=","++","--"];var s=[].slice;i.astCreateNode=function(){var t=i.AST_NODES[arguments[0]];if(!t||arguments.length-1!==t.length)throw new Error("invalid createNode");return s.call(arguments)},i.astGetProp=function(t,_){var T=i.AST_NODES[t[0]];if(!T||t.length-1!==T.length)throw new Error("invalid node getProp");return t[T.indexOf(_)+1]}},this),function(t,_){"function"==typeof define&&define.amd?define(["exports","./common"],function(_,T){t(_,T.COMMON)}):"undefined"!=typeof exports?t(exports,require("./common").COMMON):t(_.SMJS,_.SMJS.COMMON)}(function(t,_){"use strict";function T(){}T.prototype.decode=function(t,T){if(this._reset(t),this._cbWrite=T,"CJS"!==this._get(3))throw new Error("This does not appear to be an cjs stream");var e=_.r2d(this._get(1));if(0!==e)throw new Error("This decoder only supports v0 cjs streams. Stream version found: "+e);for(var i=[],r=this._nextAst();r!==!1;)r!==!0&&i.push(r),r=this._nextAst();this._resetIds();for(var s=!0,n=0,A=i.length;A>n;++n)s?s=!1:this._cbWrite(";"),this._next(i[n])},T.prototype.decodeString=function(t){var _="";return this.decode(t,function(t){_+=t}),_},T.prototype._unescape=function(t){return decodeURIComponent(t)},T.prototype._reset=function(t){this._cbWrite=null,this._code=t,this._pointer=0,this._resetIds()},T.prototype._resetIds=function(){this._ids=Object.create(null)},T.prototype._get=function(t){for(var _="";_.length<t;){if(this._pointer>=this._code.length)return!1;var T=this._code[this._pointer++];" "!==T&&"	"!==T&&"+"!==T&&"\r"!==T&&"\n"!==T&&(_+=T)}return _},T.prototype._peek=function(){return this._code[this._pointer]},T.prototype._getToEnd=function(){for(var t="",T=this._get(1);T&&T!=_.T_END;)t+=T,T=this._get(1);return t},T.prototype._nextAst=function(){var t,T=this._get(1);if(!T)return!1;if(T===_.T_NULL)return null;if(T===_.T_TABLE)return this._readTable(),this._nextAst();if(T===_.T_LITERAL_1||T===_.T_LITERAL_2||T===_.T_LITERAL_3||T===_.T_LITERAL_4)return _.astCreateNode(_.T_LITERAL,this._readSizedLiteral(parseInt(T,10)));if(T===_.T_LITERAL_TABLE)return _.astCreateNode(_.T_LITERAL,this._ids[this._get(2)]);if(T===_.T_LITERAL_CODE)return _.astCreateNode(_.T_LITERAL,this._readLiteralCode());if(T===_.T_LITERAL)return _.astCreateNode(_.T_LITERAL,this._unescape(this._getToEnd()));var e=_.AST_NODES[T];if(!e)throw new Error('unexpected token: "'+T+'"');for(var i=[T],r=0,s=e.length;s>r;++r){var n=e[r];switch(n){case _.AST_OPERATOR:i.push(this._readLiteralCode());break;case _.AST_NODE:case _.AST_LEFT:case _.AST_RIGHT:case _.AST_INIT:case _.AST_TEST:case _.AST_UPDATE:case _.AST_ALT:case _.AST_CATCH:case _.AST_FINALLY:i.push(this._nextAst());break;case _.AST_BODY:case _.AST_ARGUMENTS:for(t=[];this._peek()!==_.T_END;)t.push(this._nextAst());this._get(1),i.push(t);break;case _.AST_LITERAL:i.push(this._nextAst()[1]);break;case _.AST_OBJDEF:for(t=[];this._peek()!==_.T_END;)t.push([this._nextAst(),this._nextAst()]);this._get(1),i.push(t);break;case _.AST_VARDEF:for(t=[];this._peek()!==_.T_END;)t.push([this._nextAst()[1],this._nextAst()]);this._get(1),i.push(t);break;default:throw new Error('unhandled nodeDef:type: "'+n+'"')}}return _.astCreateNode.apply(this,i)},T.prototype._readTable=function(){this._resetIds();for(var t=0,T=this._unescape(this._getToEnd());T.length;)this._ids[_.d2r2(t++)]=T,T=this._unescape(this._getToEnd())},T.prototype._readLiteralCode=function(){return _.LITERAL_CODE_TABLE[_.r2d(this._get(1))]},T.prototype._readSizedLiteral=function(t){return this._unescape(this._get(t))},T.prototype._next=function(t){if(!(t[0]in this._map))throw new Error('Unhandled token: "'+t[0]+'"');this._map[t[0]].call(this,t)};var e=T.prototype._map={};e[_.T_ASSIGN]=e[_.T_BOP]=function(t){this._next(_.astGetProp(t,_.AST_LEFT)),this._cbWrite(" "+_.astGetProp(t,_.AST_OPERATOR)+" "),this._next(_.astGetProp(t,_.AST_RIGHT))},e[_.T_ARRAY]=function(t){var T=_.astGetProp(t,_.AST_BODY);this._cbWrite("[");for(var e=!0,i=0,r=T.length;r>i;++i)e?e=!1:this._cbWrite(","),this._next(T[i]);this._cbWrite("]")},e[_.T_BREAK]=function(t){this._cbWrite("break");var T=_.astGetProp(t,_.AST_LITERAL);null!==T&&(this._cbWrite(" "),this._cbWrite(T)),this._cbWrite(";")},e[_.T_CALL]=function(t){this._next(_.astGetProp(t,_.AST_NODE)),this._cbWrite("(");for(var T=!0,e=_.astGetProp(t,_.AST_ARGUMENTS),i=0,r=e.length;r>i;++i)T?T=!1:this._cbWrite(","),this._next(e[i]);this._cbWrite(")")},e[_.T_CONTINUE]=function(t){this._cbWrite("continue");var T=_.astGetProp(t,_.AST_LITERAL);null!==T&&(this._cbWrite(" "),this._cbWrite(T)),this._cbWrite(";")},e[_.T_EXPR]=function(t){this._next(_.astGetProp(t,_.AST_NODE)),this._cbWrite(";")},e[_.T_FUNC]=function(t){this._cbWrite("function ");var T=_.astGetProp(t,_.AST_LITERAL);null!==T&&this._cbWrite(T),this._cbWrite("(");for(var e=_.astGetProp(t,_.AST_ARGUMENTS),i=!0,r=0,s=e.length;s>r;++r)i?i=!1:this._cbWrite(","),this._next(e[r]);this._cbWrite(")"),this._next(_.astGetProp(t,_.AST_NODE))},e[_.T_FOR]=function(t){var T=_.astGetProp(t,_.AST_INIT),e=_.astGetProp(t,_.AST_TEST),i=_.astGetProp(t,_.AST_UPDATE),r=_.astGetProp(t,_.AST_NODE);this._cbWrite("for("),T&&this._next(T),this._cbWrite(";"),e&&this._next(e),this._cbWrite(";"),i&&this._next(i),this._cbWrite(")"),this._next(r)},e[_.T_FOR_IN]=function(t){this._cbWrite("for("),this._next(_.astGetProp(t,_.AST_LEFT)),this._cbWrite(" in "),this._next(_.astGetProp(t,_.AST_RIGHT)),this._cbWrite(")"),this._next(_.astGetProp(t,_.AST_NODE))},e[_.T_THROW]=function(t){this._cbWrite("throw "),this._next(_.astGetProp(t,_.AST_NODE))},e[_.T_TRY]=function(t){this._cbWrite("try "),this._next(_.astGetProp(t,_.AST_NODE));var T=_.astGetProp(t,_.AST_CATCH),e=_.astGetProp(t,_.AST_FINALLY);T&&this._next(T),e&&(this._cbWrite("finally "),this._next(e))},e[_.T_CATCH]=function(t){this._cbWrite("catch (");var T=_.astGetProp(t,_.AST_LITERAL);null!==T&&this._cbWrite(T),this._cbWrite(")"),this._next(_.astGetProp(t,_.AST_NODE))},e[_.T_IF]=function(t){this._cbWrite("if("),this._next(_.astGetProp(t,_.AST_TEST)),this._cbWrite(")"),this._next(_.astGetProp(t,_.AST_NODE));var T=_.astGetProp(t,_.AST_ALT);null!==T&&(this._cbWrite(" else "),this._next(T))},e[_.T_PREUPDATE]=function(t){this._cbWrite(_.astGetProp(t,_.AST_OPERATOR)),this._next(_.astGetProp(t,_.AST_NODE))},e[_.T_POSTUPDATE]=function(t){this._next(_.astGetProp(t,_.AST_NODE)),this._cbWrite(_.astGetProp(t,_.AST_OPERATOR))},e[_.T_SWITCH]=function(t){this._cbWrite("switch("),this._next(_.astGetProp(t,_.AST_NODE)),this._cbWrite("){");for(var T=_.astGetProp(t,_.AST_BODY),e=0,i=T.length;i>e;++e)this._next(T[e]);this._cbWrite("}\n")},e[_.T_SWITCH_CASE]=function(t){var T=_.astGetProp(t,_.AST_TEST);null===T?this._cbWrite("default: "):(this._cbWrite("case "),this._next(T),this._cbWrite(": "));for(var e=_.astGetProp(t,_.AST_BODY),i=!0,r=0,s=e.length;s>r;++r)i?i=!1:this._cbWrite(";"),this._next(e[r])},e[_.T_LITERAL]=function(t){this._cbWrite(_.astGetProp(t,_.AST_LITERAL))},e[_.T_DOT_MEMBER]=function(t){this._next(_.astGetProp(t,_.AST_LEFT)),this._cbWrite("."),this._next(_.astGetProp(t,_.AST_RIGHT))},e[_.T_ARRAY_MEMBER]=function(t){this._next(_.astGetProp(t,_.AST_LEFT)),this._cbWrite("["),this._next(_.astGetProp(t,_.AST_RIGHT)),this._cbWrite("]")},e[_.T_NEW]=function(t){this._cbWrite("new "),this._next(_.astGetProp(t,_.AST_NODE));var T=_.astGetProp(t,_.AST_ARGUMENTS);if(T.length){this._cbWrite("(");for(var e=!0,i=0,r=T.length;r>i;++i)e?e=!1:this._cbWrite(","),this._next(T[i]);this._cbWrite(")")}},e[_.T_ORDER]=function(t){this._cbWrite("("),this._next(_.astGetProp(t,_.AST_NODE)),this._cbWrite(")")},e[_.T_OBJECT]=function(t){var T=_.astGetProp(t,_.AST_OBJDEF);this._cbWrite("{");for(var e=!0,i=0,r=T.length;r>i;++i)e?e=!1:this._cbWrite(","),this._next(T[i][0]),this._cbWrite(":"),this._next(T[i][1]);this._cbWrite("}")},e[_.T_RETURN]=function(t){var T=_.astGetProp(t,_.AST_NODE);null===T?this._cbWrite("return;"):(this._cbWrite("return "),this._next(T),this._cbWrite(";"))},e[_.T_SEQ]=function(t){for(var T=_.astGetProp(t,_.AST_BODY),e=!0,i=0,r=T.length;r>i;++i)e?e=!1:this._cbWrite(","),this._next(T[i])},e[_.T_THIS]=function(){this._cbWrite("this")},e[_.T_UOP]=function(t){this._cbWrite(_.astGetProp(t,_.AST_OPERATOR)+" "),this._next(_.astGetProp(t,_.AST_NODE))},e[_.T_VAR]=function(t){this._cbWrite("var ");for(var T=_.astGetProp(t,_.AST_VARDEF),e=!0,i=0,r=T.length;r>i;++i)e?e=!1:this._cbWrite(","),this._cbWrite(T[i][0]),null!==T[i][1]&&(this._cbWrite(" = "),this._next(T[i][1]))},e[_.T_DO_WHILE]=function(t){this._cbWrite("do "),this._next(_.astGetProp(t,_.AST_NODE)),this._cbWrite(" while ("),this._next(_.astGetProp(t,_.AST_TEST)),this._cbWrite(")")},e[_.T_WHILE]=function(t){this._cbWrite("while("),this._next(_.astGetProp(t,_.AST_TEST)),this._cbWrite(")"),this._next(_.astGetProp(t,_.AST_NODE))},e[_.T_WITH]=function(t){this._cbWrite("with ("),this._next(_.astGetProp(t,_.AST_NODE)),this._cbWrite(")"),this._next(_.astGetProp(t,_.AST_ALT))},e[_.T_LABEL]=function(t){this._cbWrite(_.astGetProp(t,_.AST_LITERAL)),this._cbWrite(":"),this._next(_.astGetProp(t,_.AST_NODE))},e[_.T_CONDITIONAL]=function(t){this._next(_.astGetProp(t,_.AST_TEST)),this._cbWrite(" ? "),this._next(_.astGetProp(t,_.AST_NODE)),this._cbWrite(" : "),this._next(_.astGetProp(t,_.AST_ALT))},e[_.T_EMPTY]=function(){this._cbWrite(";")},e[_.T_BLOCK]=function(t){this._cbWrite("{");for(var T=_.astGetProp(t,_.AST_BODY),e=!0,i=0,r=T.length;r>i;++i)e?e=!1:this._cbWrite(";"),this._next(T[i]);this._cbWrite("}\n")},t.Decoder=T},this);